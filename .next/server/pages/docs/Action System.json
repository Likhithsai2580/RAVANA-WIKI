{"pageProps":{"doc":{"slug":"Action System","title":"Action System","content":"<h1>Action System</h1>\n<h2>Update Summary</h2>\n<p><strong>Changes Made</strong></p>\n<ul>\n<li>Updated Coding Actions section to reflect enhanced code generation prompt with structured role, task instructions, reasoning framework, output requirements, and safety constraints</li>\n<li>Added new section on Prompt Management System to explain centralized prompt handling</li>\n<li>Enhanced security considerations with additional safety constraints from the enhanced prompt</li>\n<li>Updated referenced files list to include prompt_manager.py, code_generation.json, and llm.py</li>\n<li>Added details about dynamic prompt enhancement with mood adaptation and safety constraints</li>\n</ul>\n<h2>Table of Contents</h2>\n<ol>\n<li><a href=\"#introduction\">Introduction</a></li>\n<li><a href=\"#action-base-class-and-execute-contract\">Action Base Class and Execute Contract</a></li>\n<li><a href=\"#action-registry-and-discovery-mechanism\">Action Registry and Discovery Mechanism</a></li>\n<li><a href=\"#action-manager-execution-lifecycle\">Action Manager Execution Lifecycle</a></li>\n<li><a href=\"#built-in-action-types-and-use-cases\">Built-in Action Types and Use Cases</a></li>\n<li><a href=\"#prompt-management-system\">Prompt Management System</a></li>\n<li><a href=\"#defining-and-registering-custom-actions\">Defining and Registering Custom Actions</a></li>\n<li><a href=\"#system-state-and-service-interaction\">System State and Service Interaction</a></li>\n<li><a href=\"#security-considerations-for-action-execution\">Security Considerations for Action Execution</a></li>\n<li><a href=\"#troubleshooting-common-issues\">Troubleshooting Common Issues</a></li>\n<li><a href=\"#conclusion\">Conclusion</a></li>\n</ol>\n<h2>Introduction</h2>\n<p>The Action System is a core component of the Ravana AGI framework, responsible for executing tasks based on decisions made by the decision engine. It provides a structured, extensible mechanism for defining, registering, and executing actions that the AGI can perform. The system is designed with modularity, safety, and scalability in mind, enabling both built-in and custom actions to be seamlessly integrated. This document provides a comprehensive overview of the action system's architecture, functionality, and best practices.</p>\n<h2>Action Base Class and Execute Contract</h2>\n<p>The <code>Action</code> class serves as the abstract base class for all executable actions within the system. It defines a standardized interface that ensures consistency across different types of actions.</p>\n<pre><code>classDiagram\nclass Action {\n&#x3C;&#x3C;abstract>>\n+system : AGISystem\n+data_service : DataService\n+name : str\n+description : str\n+parameters : List[Dict[str, Any]]\n+execute(**kwargs : Any) : Any\n+validate_params(params : Dict[str, Any]) : None\n+to_dict() : Dict[str, Any]\n+to_json() : str\n}\nAction &#x3C;|-- WritePythonCodeAction\nAction &#x3C;|-- ExecutePythonFileAction\nAction &#x3C;|-- LogMessageAction\nAction &#x3C;|-- ProposeAndTestInventionAction\nAction &#x3C;|-- ProcessImageAction\nAction &#x3C;|-- BlogPublishAction\nAction &#x3C;|-- CollaborativeTaskAction\n</code></pre>\n<p><strong>Diagram sources</strong></p>\n<ul>\n<li><a>action.py</a></li>\n</ul>\n<h3>Key Properties</h3>\n<ul>\n<li><strong>name</strong>: A unique identifier for the action (e.g., \"write_python_code\")</li>\n<li><strong>description</strong>: Human-readable explanation of what the action does</li>\n<li><strong>parameters</strong>: List of dictionaries defining input parameters with name, type, description, and required status</li>\n</ul>\n<h3>Execute Method Contract</h3>\n<p>The <code>execute</code> method is an abstract async method that must be implemented by all subclasses. It receives keyword arguments matching the defined parameters and returns the result of the action execution. The method contract requires:</p>\n<ul>\n<li>Parameter validation via <code>validate_params</code> before execution</li>\n<li>Asynchronous execution using <code>async/await</code> pattern</li>\n<li>Proper error handling and logging</li>\n<li>Return of a dictionary with status information or execution results</li>\n</ul>\n<h3>Validation and Serialization</h3>\n<p>The base class provides built-in validation through <code>validate_params</code>, which checks for missing required parameters and unexpected parameters. It also includes <code>to_dict</code> and <code>to_json</code> methods for serializing action metadata, which is used in LLM prompts and API responses.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>action.py</a></li>\n</ul>\n<h2>Action Registry and Discovery Mechanism</h2>\n<p>The <code>ActionRegistry</code> is responsible for managing the collection of available actions and providing lookup functionality.</p>\n<pre><code>classDiagram\nclass ActionRegistry {\n-actions : Dict[str, Action]\n+__init__(system : AGISystem, data_service : DataService)\n+_register_action(action : Action) : None\n+register_action(action : Action) : None\n+discover_actions() : None\n+get_action(name : str) : Action\n+get_all_actions() : List[Action]\n+get_action_definitions() : str\n}\nActionRegistry --> Action : \"contains\"\n</code></pre>\n<p><strong>Diagram sources</strong></p>\n<ul>\n<li><a>registry.py</a></li>\n</ul>\n<h3>Registration Process</h3>\n<p>The registry initializes with several built-in actions:</p>\n<ul>\n<li><code>ProposeAndTestInventionAction</code></li>\n<li><code>LogMessageAction</code></li>\n<li><code>WritePythonCodeAction</code></li>\n<li><code>ExecutePythonFileAction</code></li>\n<li><code>BlogPublishAction</code></li>\n<li><code>CollaborativeTaskAction</code></li>\n</ul>\n<p>These are registered during initialization with their required dependencies (system and data_service). The <code>CollaborativeTaskAction</code> is now included as a core built-in action, reflecting its importance in the cross-system task delegation workflow.</p>\n<h3>Public Registration Methods</h3>\n<ul>\n<li><strong>register_action</strong>: Public method to register a new action instance</li>\n<li><strong>_register_action</strong>: Internal method that handles registration with overwrite warnings</li>\n</ul>\n<h3>Automatic Discovery</h3>\n<p>The <code>discover_actions</code> method uses Python's <code>pkgutil.walk_packages</code> to automatically discover and register all action classes in the <code>core.actions</code> package. It:</p>\n<ol>\n<li>Iterates through all modules in the actions package</li>\n<li>Imports each module</li>\n<li>Finds all classes that inherit from <code>Action</code> (excluding the base class itself)</li>\n<li>Instantiates and registers each action</li>\n<li>Logs warnings for duplicate names and errors for instantiation failures</li>\n</ol>\n<p>This discovery mechanism enables plug-and-play extensibility - new actions can be added by simply creating a new file in the actions directory with a properly defined action class.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>registry.py</a></li>\n</ul>\n<h2>Action Manager Execution Lifecycle</h2>\n<p>The <code>ActionManager</code> orchestrates the execution of actions, handling the complete lifecycle from decision parsing to result return.</p>\n<pre><code>sequenceDiagram\nparticipant DecisionEngine\nparticipant ActionManager\nparticipant ActionRegistry\nparticipant Action\nparticipant DataService\nDecisionEngine->>ActionManager : execute_action(decision)\nActionManager->>ActionManager : Parse decision format\nalt Raw LLM Response\nActionManager->>ActionManager : Extract JSON from response\nActionManager->>ActionManager : Parse JSON to action_data\nelse Pre-parsed Action\nActionManager->>ActionManager : Use action_data directly\nend\nActionManager->>ActionManager : Validate action_data structure\nActionManager->>ActionRegistry : get_action(action_name)\nActionRegistry-->>ActionManager : Return Action instance\nActionManager->>Action : execute(**action_params)\nAction-->>ActionManager : Return execution result\nActionManager->>DataService : save_action_log(success)\nActionManager-->>DecisionEngine : Return result\nalt Execution Error\nAction-->>ActionManager : Raise exception\nActionManager->>DataService : save_action_log(error)\nActionManager-->>DecisionEngine : Return error object\nend\n</code></pre>\n<p><strong>Diagram sources</strong></p>\n<ul>\n<li><a>action_manager.py</a></li>\n</ul>\n<h3>Decision Parsing</h3>\n<p>The <code>execute_action</code> method handles two decision formats:</p>\n<ol>\n<li><strong>Pre-parsed action dictionary</strong>: Contains \"action\" and \"params\" keys</li>\n<li><strong>Raw LLM response</strong>: Contains \"raw_response\" with JSON embedded in markdown code blocks</li>\n</ol>\n<p>For raw responses, the system extracts the JSON block using string manipulation and parses it. If no valid JSON block is found, it attempts to parse the entire response as JSON.</p>\n<h3>Execution Flow</h3>\n<ol>\n<li>Extract action name and parameters from the decision</li>\n<li>Retrieve the action instance from the registry</li>\n<li>Log the execution attempt</li>\n<li>Execute the action with provided parameters</li>\n<li>Log successful execution to the database</li>\n<li>Return the result</li>\n</ol>\n<h3>Error Handling</h3>\n<p>The execution lifecycle includes comprehensive error handling:</p>\n<ul>\n<li><strong>ActionException</strong>: For expected action-related errors (logged with error status)</li>\n<li><strong>General Exception</strong>: For unexpected errors (logged with full traceback)</li>\n<li>All errors are logged to the database via <code>save_action_log</code></li>\n</ul>\n<p>The method returns a standardized error object with an \"error\" key, ensuring consistent error reporting to the decision engine.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>action_manager.py</a></li>\n</ul>\n<h2>Built-in Action Types and Use Cases</h2>\n<p>The system provides several built-in action types categorized by functionality.</p>\n<h3>Coding Actions</h3>\n<p>These actions enable the AGI to generate and execute code.</p>\n<h4>WritePythonCodeAction</h4>\n<p>Generates Python code based on a hypothesis and test plan using the LLM with an enhanced prompt structure.</p>\n<p><strong>Parameters:</strong></p>\n<ul>\n<li><strong>file_path</strong>: Where to save the generated code</li>\n<li><strong>hypothesis</strong>: The concept to test</li>\n<li><strong>test_plan</strong>: How to test the hypothesis</li>\n</ul>\n<p>The action uses a structured prompt template with multiple sections to guide code generation:</p>\n<ul>\n<li><strong>[ROLE DEFINITION]</strong>: Defines the AI as an expert programmer</li>\n<li><strong>[CONTEXT]</strong>: Provides the hypothesis and test plan</li>\n<li><strong>[TASK INSTRUCTIONS]</strong>: Step-by-step process for code generation</li>\n<li><strong>[REASONING FRAMEWORK]</strong>: Software engineering best practices</li>\n<li><strong>[OUTPUT REQUIREMENTS]</strong>: Specifications for code quality and format</li>\n<li><strong>[SAFETY CONSTRAINTS]</strong>: Security and reliability guidelines</li>\n</ul>\n<p>The prompt ensures high-quality code generation by requiring:</p>\n<ul>\n<li>Clear, descriptive variable and function names</li>\n<li>Comprehensive inline documentation</li>\n<li>Proper error handling and edge case management</li>\n<li>Efficient algorithms and data structures</li>\n<li>Adherence to Python conventions and best practices</li>\n<li>Confidence score for solution correctness (0.0-1.0)</li>\n</ul>\n<p>The action extracts code from markdown code blocks in the LLM response and writes it to the specified file.</p>\n<h4>ExecutePythonFileAction</h4>\n<p>Executes a Python script and captures its output.</p>\n<p><strong>Parameters:</strong></p>\n<ul>\n<li><strong>file_path</strong>: Path to the Python script</li>\n</ul>\n<p>Uses <code>asyncio.create_subprocess_shell</code> to run the script, capturing stdout and stderr. Returns execution results including return code and output.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>coding.py</a></li>\n<li><a>code_generation.json</a></li>\n<li><a>prompt_manager.py</a></li>\n<li><a>llm.py</a></li>\n</ul>\n<h3>IO Actions</h3>\n<h4>LogMessageAction</h4>\n<p>Records messages to the console with configurable logging levels.</p>\n<p><strong>Parameters:</strong></p>\n<ul>\n<li><strong>message</strong>: Content to log</li>\n<li><strong>level</strong>: Logging level (info, warning, error)</li>\n</ul>\n<p>Appends \"[AGI Thought]:\" prefix to messages for easy identification in logs.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>io.py</a></li>\n</ul>\n<h3>Multi-modal Actions</h3>\n<p>These actions process various media types and are registered by the <code>EnhancedActionManager</code>.</p>\n<h4>ProcessImageAction</h4>\n<p>Analyzes image files using multi-modal services.</p>\n<h4>ProcessAudioAction</h4>\n<p>Processes and analyzes audio files.</p>\n<h4>AnalyzeDirectoryAction</h4>\n<p>Analyzes all media files in a directory, optionally recursively.</p>\n<h4>CrossModalAnalysisAction</h4>\n<p>Performs analysis across multiple content types.</p>\n<p>These actions validate file existence before processing and can add results to the knowledge base.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>multi_modal.py</a></li>\n<li><a>enhanced_action_manager.py</a></li>\n</ul>\n<h3>Experimental Actions</h3>\n<h4>ProposeAndTestInventionAction</h4>\n<p>Enables the AGI to propose novel ideas and test them through the experimentation engine.</p>\n<p><strong>Parameters:</strong></p>\n<ul>\n<li><strong>invention_description</strong>: The novel concept</li>\n<li><strong>test_plan_suggestion</strong>: How to test it</li>\n</ul>\n<p>Frames the invention as a hypothesis and runs it through the advanced experimentation engine, logging results to the database. This action represents the AGI's creative and scientific reasoning capabilities.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>experimental.py</a></li>\n</ul>\n<h3>Blog Actions</h3>\n<p>New blog-specific actions have been added to support autonomous content creation and publishing.</p>\n<h4>BlogPublishAction</h4>\n<p>Orchestrates the complete blog publishing workflow, from content generation to platform publication.</p>\n<pre><code>classDiagram\nclass BlogPublishAction {\n+api_interface : BlogAPIInterface\n+content_generator : BlogContentGenerator\n+name : str\n+description : str\n+parameters : List[Dict[str, Any]]\n+execute(**kwargs : Any) : Dict[str, Any]\n+_log_blog_action(result : Dict[str, Any], action_type : str) : None\n+_format_memory_content(result : Dict[str, Any], action_type : str) : str\n+test_connection() : Dict[str, Any]\n+_calculate_emotional_valence(result : Dict[str, Any], action_type : str) : float\n+get_configuration_info() : Dict[str, Any]\n}\nBlogPublishAction --|> Action : \"inherits\"\nBlogPublishAction --> BlogAPIInterface : \"uses\"\nBlogPublishAction --> BlogContentGenerator : \"uses\"\n</code></pre>\n<p><strong>Diagram sources</strong></p>\n<ul>\n<li><a>blog.py</a></li>\n<li><a>blog_api.py</a></li>\n<li><a>blog_content_generator.py</a></li>\n</ul>\n<p><strong>Parameters:</strong></p>\n<ul>\n<li><strong>topic</strong>: Main subject for the blog post (required)</li>\n<li><strong>style</strong>: Writing style from available options (optional)</li>\n<li><strong>context</strong>: Additional aspects to focus on (optional)</li>\n<li><strong>custom_tags</strong>: Tags to include beyond auto-generated ones (optional)</li>\n<li><strong>dry_run</strong>: If true, generates content without publishing (optional)</li>\n</ul>\n<p>The action follows a comprehensive workflow:</p>\n<ol>\n<li>Validates configuration and parameters</li>\n<li>Generates content using LLM with memory context</li>\n<li>Validates API configuration</li>\n<li>Publishes to the blog platform</li>\n<li>Logs results to data and memory services</li>\n</ol>\n<p>The action includes comprehensive error handling for content generation failures, API errors, and unexpected exceptions. It also provides utility methods like <code>test_connection()</code> for API connectivity testing and <code>get_configuration_info()</code> for retrieving current blog settings.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>blog.py</a></li>\n<li><a>blog_api.py</a></li>\n<li><a>blog_content_generator.py</a></li>\n</ul>\n<h3>Collaborative Task Actions</h3>\n<p>New collaborative task actions have been added to support cross-system task delegation and user collaboration.</p>\n<h4>CollaborativeTaskAction</h4>\n<p>Manages collaborative tasks between RAVANA and users with feedback mechanisms.</p>\n<pre><code>classDiagram\nclass CollaborativeTaskAction {\n+system : AGISystem\n+data_service : DataService\n+collaborative_tasks : Dict[str, Any]\n+task_feedback : Dict[str, Any]\n+name : str\n+description : str\n+parameters : List[Dict[str, Any]]\n+execute(**kwargs : Any) : Dict[str, Any]\n+_create_task(title : str, description : str, user_id : str, priority : str, deadline : str) : Dict[str, Any]\n+_update_task(task_id : str, title : str, description : str, priority : str, deadline : str) : Dict[str, Any]\n+_complete_task(task_id : str) : Dict[str, Any]\n+_cancel_task(task_id : str) : Dict[str, Any]\n+_provide_feedback(task_id : str, user_id : str, feedback : str, feedback_type : str, rating : int) : Dict[str, Any]\n+_request_feedback(task_id : str, user_id : str) : Dict[str, Any]\n+get_task(task_id : str) : Dict[str, Any]\n+get_user_tasks(user_id : str) : list\n+get_task_feedback(task_id : str) : List[Dict[str, Any]]\n+get_user_feedback(user_id : str) : List[Dict[str, Any]]\n+analyze_collaboration_patterns() : Dict[str, Any]\n+_get_most_active_users() : Dict[str, int]\n}\nCollaborativeTaskAction --|> Action : \"inherits\"\n</code></pre>\n<p><strong>Diagram sources</strong></p>\n<ul>\n<li><a>collaborative_task.py</a></li>\n</ul>\n<p><strong>Parameters:</strong></p>\n<ul>\n<li><strong>task_type</strong>: Type of collaborative task (create, update, complete, cancel, provide_feedback, request_feedback)</li>\n<li><strong>task_id</strong>: Unique identifier for the task (required for update, complete, cancel, provide_feedback)</li>\n<li><strong>title</strong>: Title of the task (required for create)</li>\n<li><strong>description</strong>: Detailed description of the task</li>\n<li><strong>user_id</strong>: User ID to collaborate with</li>\n<li><strong>priority</strong>: Priority level (low, medium, high, critical)</li>\n<li><strong>deadline</strong>: Deadline for task completion (ISO format)</li>\n<li><strong>feedback</strong>: Feedback content (required for provide_feedback)</li>\n<li><strong>feedback_type</strong>: Type of feedback (positive, negative, suggestion, question)</li>\n<li><strong>rating</strong>: Numerical rating for the task (1-10)</li>\n</ul>\n<p>The action supports a comprehensive workflow for collaborative task management:</p>\n<ol>\n<li><strong>Create tasks</strong>: Initiates new collaborative tasks with users</li>\n<li><strong>Update tasks</strong>: Modifies existing task details</li>\n<li><strong>Complete tasks</strong>: Marks tasks as completed with user notification</li>\n<li><strong>Cancel tasks</strong>: Cancels tasks with user notification</li>\n<li><strong>Provide feedback</strong>: Collects user feedback on task performance</li>\n<li><strong>Request feedback</strong>: Proactively requests feedback from users</li>\n</ol>\n<p>The action integrates with the conversational AI system to send notifications and messages to users at key points in the task lifecycle. It maintains in-memory storage for tasks and feedback, with comprehensive logging and history tracking for all collaboration events.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>collaborative_task.py</a></li>\n</ul>\n<h2>Prompt Management System</h2>\n<p>The system now features a centralized PromptManager that handles all prompt templates and their dynamic enhancement.</p>\n<pre><code>classDiagram\nclass PromptManager {\n+agi_system : AGISystem\n+repository : PromptRepository\n+enhancer : PromptEnhancer\n+__init__(agi_system : AGISystem)\n+_register_default_templates() : None\n+get_prompt(template_name : str, context : Dict[str, Any]) : str\n+register_prompt_template(name : str, template : str, metadata : Dict[str, Any]) : None\n+_post_process_prompt(prompt : str, context : Dict[str, Any]) : str\n}\nPromptManager --> PromptRepository : \"uses\"\nPromptManager --> PromptEnhancer : \"uses\"\n</code></pre>\n<p><strong>Diagram sources</strong></p>\n<ul>\n<li><a>prompt_manager.py</a></li>\n</ul>\n<h3>Centralized Prompt Repository</h3>\n<p>The PromptManager uses a repository pattern to store and retrieve prompt templates from JSON files in the prompts directory. Each template includes:</p>\n<ul>\n<li><strong>name</strong>: Unique identifier for the prompt</li>\n<li><strong>template</strong>: The actual prompt text with placeholders</li>\n<li><strong>metadata</strong>: Additional information about category, description, and version</li>\n<li><strong>version</strong>: Version tracking for prompt evolution</li>\n<li><strong>created_at/updated_at</strong>: Timestamps for version history</li>\n</ul>\n<h3>Enhanced Prompt Structure</h3>\n<p>The coding action now uses a structured prompt with multiple sections that guide the LLM's response:</p>\n<ul>\n<li><strong>[ROLE DEFINITION]</strong>: Establishes the AI's identity and expertise</li>\n<li><strong>[CONTEXT]</strong>: Provides specific task details and parameters</li>\n<li><strong>[TASK INSTRUCTIONS]</strong>: Step-by-step process for completing the task</li>\n<li><strong>[REASONING FRAMEWORK]</strong>: Methodological approach to problem-solving</li>\n<li><strong>[OUTPUT REQUIREMENTS]</strong>: Specific format and quality expectations</li>\n<li><strong>[SAFETY CONSTRAINTS]</strong>: Security and reliability guidelines</li>\n</ul>\n<h3>Dynamic Prompt Enhancement</h3>\n<p>The system applies dynamic enhancements to prompts through post-processing:</p>\n<ul>\n<li><strong>Mood adaptation</strong>: Adjusts prompt tone based on the AI's emotional state</li>\n<li><strong>Safety constraints</strong>: Adds context-specific safety requirements</li>\n<li><strong>Confidence scoring</strong>: Requires the LLM to include confidence scores</li>\n<li><strong>Risk assessment</strong>: Adds requirements for risk identification and mitigation</li>\n</ul>\n<h3>Template Registration and Retrieval</h3>\n<p>The system automatically loads all JSON files in the prompts directory as templates. Templates can be retrieved by name with context variables that are automatically substituted. The system validates prompts for required sections before use.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>prompt_manager.py</a></li>\n<li><a>code_generation.json</a></li>\n</ul>\n<h2>Defining and Registering Custom Actions</h2>\n<p>Creating custom actions follows a straightforward process outlined in the developer guide.</p>\n<h3>Action Structure Requirements</h3>\n<p>All custom actions must:</p>\n<ol>\n<li>Inherit from the <code>Action</code> base class</li>\n<li>Implement the required properties (<code>name</code>, <code>description</code>, <code>parameters</code>)</li>\n<li>Implement the <code>execute</code> method with async functionality</li>\n</ol>\n<h3>Step-by-Step Implementation</h3>\n<ol>\n<li><strong>Create a Python file</strong> in <code>core/actions/</code> (e.g., <code>core/actions/misc.py</code>)</li>\n<li><strong>Define the action class</strong> inheriting from <code>Action</code></li>\n<li><strong>Implement required properties</strong> with appropriate metadata</li>\n<li><strong>Implement the execute method</strong> with the desired functionality</li>\n</ol>\n<pre><code class=\"language-python\">from core.actions.action import Action\nfrom typing import Any, Dict, List\n\nclass HelloWorldAction(Action):\n    @property\n    def name(self) -> str:\n        return \"hello_world\"\n\n    @property\n    def description(self) -> str:\n        return \"A simple action that prints a greeting.\"\n\n    @property\n    def parameters(self) -> List[Dict[str, Any]]:\n        return [\n            {\n                \"name\": \"name\",\n                \"type\": \"string\",\n                \"description\": \"The name to include in the greeting.\",\n                \"required\": True,\n            }\n        ]\n\n    async def execute(self, **kwargs: Any) -> Any:\n        name = kwargs.get(\"name\")\n        return f\"Hello, {name}!\"\n</code></pre>\n<h3>Registration Mechanism</h3>\n<p>Custom actions are automatically discovered and registered when:</p>\n<ul>\n<li>The action class is defined in a module within <code>core.actions</code></li>\n<li>The class inherits from <code>Action</code> and is not the base class itself</li>\n<li>The module is importable</li>\n</ul>\n<p>No manual registration is required - the <code>discover_actions</code> method will automatically find and instantiate the action during system initialization.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>DEVELOPER_GUIDE.md</a></li>\n<li><a>action.py</a></li>\n<li><a>registry.py</a></li>\n</ul>\n<h2>System State and Service Interaction</h2>\n<p>Actions interact with system state and services through dependencies injected during initialization.</p>\n<h3>Dependency Injection</h3>\n<p>The <code>Action</code> base class constructor accepts two dependencies:</p>\n<ul>\n<li><strong>system</strong>: Reference to the main <code>AGISystem</code> instance</li>\n<li><strong>data_service</strong>: Reference to the <code>DataService</code> for database operations</li>\n</ul>\n<p>These dependencies are passed down from the <code>ActionManager</code> through the <code>ActionRegistry</code> to all action instances.</p>\n<h3>State Access Patterns</h3>\n<p>Actions access system state through the injected dependencies:</p>\n<ul>\n<li><strong>AGISystem</strong>: Provides access to other system components like <code>knowledge_service</code></li>\n<li><strong>DataService</strong>: Enables database operations like logging actions and experiments</li>\n</ul>\n<p>For example, the <code>ProposeAndTestInventionAction</code> uses <code>self.data_service.save_experiment_log</code> to record experiment results, while multi-modal actions use <code>self.system.knowledge_service.add_knowledge</code> to update the knowledge base.</p>\n<h3>Service Integration</h3>\n<p>The enhanced action manager demonstrates deeper service integration by:</p>\n<ul>\n<li>Creating a <code>MultiModalService</code> instance for media processing</li>\n<li>Using <code>asyncio.to_thread</code> to call synchronous service methods without blocking the event loop</li>\n<li>Implementing caching mechanisms to improve performance</li>\n</ul>\n<p>This pattern ensures that actions can leverage system services while maintaining proper separation of concerns.</p>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>action.py</a></li>\n<li><a>action_manager.py</a></li>\n<li><a>enhanced_action_manager.py</a></li>\n</ul>\n<h2>Security Considerations for Action Execution</h2>\n<p>The action system incorporates several security measures to prevent misuse and ensure safe execution.</p>\n<h3>Code Execution Safety</h3>\n<p>The <code>ExecutePythonFileAction</code> executes code in subprocesses, which provides isolation from the main application process. However, this still represents a potential security risk as executed code has full system access.</p>\n<p>The <code>EnhancedActionManager</code> implements a 5-minute timeout for action execution using <code>asyncio.wait_for</code>, preventing infinite loops or long-running processes from blocking the system.</p>\n<h3>Enhanced Safety Constraints</h3>\n<p>The enhanced code generation prompt includes comprehensive safety constraints:</p>\n<ul>\n<li><strong>Security vulnerabilities</strong>: Prevents injection, buffer overflows, and other vulnerabilities</li>\n<li><strong>Resource leaks</strong>: Ensures proper resource management and memory handling</li>\n<li><strong>Unintended actions</strong>: Validates that code performs only intended operations</li>\n<li><strong>Input/output validation</strong>: Requires validation of all inputs and outputs</li>\n<li><strong>Secure coding practices</strong>: Enforces adherence to security best practices</li>\n</ul>\n<p>These constraints are embedded in the prompt structure and are applied to all code generation requests.</p>\n<h3>Blog-Specific Security</h3>\n<p>The <code>BlogPublishAction</code> introduces new security considerations:</p>\n<ul>\n<li><strong>API Key Management</strong>: The action uses the enhanced Gemini API key management system with automatic rotation</li>\n<li><strong>Content Validation</strong>: Generated content is validated before publication</li>\n<li><strong>Dry Run Mode</strong>: Allows content generation without actual publication for review</li>\n<li><strong>Configuration Validation</strong>: API configuration is validated before any publication attempts</li>\n</ul>\n<h3>Collaboration-Specific Security</h3>\n<p>The <code>CollaborativeTaskAction</code> introduces new security considerations:</p>\n<ul>\n<li><strong>User ID Validation</strong>: Ensures user IDs are properly validated before task creation</li>\n<li><strong>Rating Validation</strong>: Validates that ratings are within the 1-10 range</li>\n<li><strong>Feedback Sanitization</strong>: Should implement input sanitization for feedback content</li>\n<li><strong>Task Ownership</strong>: Ensures users can only modify tasks they own</li>\n</ul>\n<h3>Input Validation</h3>\n<p>The base <code>Action</code> class includes <code>validate_params</code> which:</p>\n<ul>\n<li>Checks for missing required parameters</li>\n<li>Rejects unexpected parameters</li>\n<li>Raises <code>InvalidActionParams</code> for invalid inputs</li>\n</ul>\n<p>This prevents actions from executing with incomplete or malformed data.</p>\n<h3>Permission and Access Control</h3>\n<p>Currently, the system lacks explicit permission controls. Actions have access to:</p>\n<ul>\n<li>Full file system (via file paths)</li>\n<li>Database operations</li>\n<li>System process execution</li>\n</ul>\n<p>For production use, additional security layers should be implemented, such as:</p>\n<ul>\n<li>Sandboxed execution environments</li>\n<li>File system access restrictions</li>\n<li>Rate limiting for resource-intensive actions</li>\n<li>Action-specific permission policies</li>\n</ul>\n<h3>Self-Modification Risks</h3>\n<p>The system allows actions to write and execute code, creating potential self-modification capabilities. While this enables powerful autonomous behavior, it also introduces risks:</p>\n<ul>\n<li>Code generation errors could corrupt system functionality</li>\n<li>Malicious LLM output could introduce harmful code</li>\n<li>Recursive self-modification could lead to instability</li>\n</ul>\n<p>Mitigation strategies include:</p>\n<ul>\n<li>Code review before execution (not currently implemented)</li>\n<li>Backup and rollback mechanisms</li>\n<li>Execution in isolated environments</li>\n<li>Static analysis of generated code</li>\n</ul>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>action_manager.py</a></li>\n<li><a>enhanced_action_manager.py</a></li>\n<li><a>coding.py</a></li>\n<li><a>blog.py</a></li>\n<li><a>collaborative_task.py</a></li>\n<li><a>prompt_manager.py</a></li>\n</ul>\n<h2>Troubleshooting Common Issues</h2>\n<h3>Registration Failures</h3>\n<p><strong>Symptoms:</strong> Action not found in registry, <code>ActionException</code> with \"Action 'action_name' not found\"\n<strong>Causes and Solutions:</strong></p>\n<ul>\n<li><strong>Class not discovered</strong>: Ensure the action class is in a module within <code>core.actions</code> and properly imports the <code>Action</code> base class</li>\n<li><strong>Instantiation error</strong>: Check for exceptions in the <code>__init__</code> method; the discovery mechanism logs instantiation errors</li>\n<li><strong>Name collision</strong>: The registry overwrites actions with duplicate names; check logs for overwrite warnings</li>\n<li><strong>Missing required properties</strong>: Verify implementation of <code>name</code>, <code>description</code>, and <code>parameters</code> properties</li>\n</ul>\n<h3>Execution Timeouts</h3>\n<p><strong>Symptoms:</strong> Actions failing with \"Action timed out\" message\n<strong>Causes and Solutions:</strong></p>\n<ul>\n<li><strong>Long-running operations</strong>: The <code>EnhancedActionManager</code> enforces a 5-minute timeout; optimize action logic or increase timeout if appropriate</li>\n<li><strong>Blocking operations</strong>: Ensure all I/O operations use async patterns; use <code>asyncio.to_thread</code> for synchronous calls</li>\n<li><strong>Resource constraints</strong>: Check system resources (CPU, memory, disk I/O) that may slow execution</li>\n</ul>\n<h3>Permission Issues</h3>\n<p><strong>Symptoms:</strong> File not found, permission denied, or subprocess execution failures\n<strong>Causes and Solutions:</strong></p>\n<ul>\n<li><strong>File access</strong>: Verify the application has read/write permissions to specified file paths</li>\n<li><strong>Directory existence</strong>: Check that directories exist before writing files</li>\n<li><strong>Subprocess execution</strong>: Ensure Python is in the system PATH and the executing user has permission to run subprocesses</li>\n<li><strong>Absolute vs relative paths</strong>: Use absolute paths or ensure relative paths are correct relative to the working directory</li>\n</ul>\n<h3>Parameter Validation Errors</h3>\n<p><strong>Symptoms:</strong> <code>InvalidActionParams</code> exceptions with messages about missing or unexpected parameters\n<strong>Causes and Solutions:</strong></p>\n<ul>\n<li><strong>Missing required parameters</strong>: Ensure all parameters marked as <code>required: True</code> are provided</li>\n<li><strong>Typos in parameter names</strong>: Double-check parameter names match exactly</li>\n<li><strong>Extra parameters</strong>: Remove parameters not defined in the action's <code>parameters</code> list</li>\n<li><strong>Type mismatches</strong>: Ensure parameter values match the expected types</li>\n</ul>\n<h3>General Debugging Tips</h3>\n<ul>\n<li>Check application logs for detailed error messages and stack traces</li>\n<li>Verify action registration by checking the \"Available Actions\" log output during startup</li>\n<li>Use the <code>get_action_definitions</code> method to inspect registered action schemas</li>\n<li>Test actions in isolation when possible</li>\n<li>Monitor the action log database table for execution history and errors</li>\n</ul>\n<p><strong>Section sources</strong></p>\n<ul>\n<li><a>action_manager.py</a></li>\n<li><a>action.py</a></li>\n<li><a>exceptions.py</a></li>\n<li><a>enhanced_action_manager.py</a></li>\n</ul>\n<h2>Conclusion</h2>\n<p>The Action System in the Ravana AGI framework provides a robust, extensible foundation for autonomous behavior. By defining a clear contract through the <code>Action</code> base class, implementing a flexible registration mechanism in <code>ActionRegistry</code>, and orchestrating execution through <code>ActionManager</code>, the system enables both built-in and custom actions to be seamlessly integrated. The architecture supports various action types including coding, IO, multi-modal, experimental, blog-specific, and now collaborative task actions, allowing the AGI to perform diverse tasks. The recent addition of <code>CollaborativeTaskAction</code> enhances the system's cross-system task delegation capabilities, enabling end-to-end collaborative workflows with user feedback mechanisms. The enhanced prompt management system with structured templates and dynamic enhancement significantly improves code generation quality and safety. While the system includes basic security measures like input validation and execution timeouts, additional safeguards would be beneficial for production deployment, particularly around code execution and permission controls. The automatic discovery mechanism and clear implementation guidelines make it straightforward to extend the AGI's capabilities with new actions, supporting the system's goal of continuous learning and adaptation.</p>\n<p><strong>Referenced Files in This Document</strong></p>\n<ul>\n<li><a>action.py</a> - <em>Base Action class implementation</em></li>\n<li><a>registry.py</a> - <em>ActionRegistry with CollaborativeTaskAction registration</em></li>\n<li><a>action_manager.py</a></li>\n<li><a>coding.py</a> - <em>Enhanced code generation prompt implementation</em></li>\n<li><a>io.py</a></li>\n<li><a>multi_modal.py</a></li>\n<li><a>experimental.py</a></li>\n<li><a>exceptions.py</a></li>\n<li><a>enhanced_action_manager.py</a></li>\n<li><a>blog.py</a> - <em>Added in recent commit</em></li>\n<li><a>blog_api.py</a> - <em>Dependency for BlogPublishAction</em></li>\n<li><a>blog_content_generator.py</a> - <em>Dependency for BlogPublishAction</em></li>\n<li><a>collaborative_task.py</a> - <em>Added in recent commit</em></li>\n<li><a>DEVELOPER_GUIDE.md</a></li>\n<li><a>prompt_manager.py</a> - <em>Prompt management system with enhanced templates</em></li>\n<li><a>code_generation.json</a> - <em>Enhanced code generation prompt template</em></li>\n<li><a>llm.py</a> - <em>LLM integration and call handling</em></li>\n</ul>\n"},"docs":[{"slug":"Action System","title":"Action System"},{"slug":"API Reference","title":"API Reference"},{"slug":"Architecture & Design","title":"Architecture & Design"},{"slug":"Configuration","title":"Configuration"},{"slug":"Conversational AI Communication Framework","title":"Conversational AI Communication Framework"},{"slug":"Core System","title":"Core System"},{"slug":"Database Schema","title":"Database Schema"},{"slug":"Decision-Making System","title":"Decision-Making System"},{"slug":"Deployment & Operations","title":"Deployment & Operations"},{"slug":"Development Guide","title":"Development Guide"},{"slug":"Emotional Intelligence","title":"Emotional Intelligence"},{"slug":"Enhanced Snake Agent","title":"Enhanced Snake Agent"},{"slug":"Enhanced Snake Agent Architecture","title":"Enhanced Snake Agent Architecture"},{"slug":"Graceful Shutdown","title":"Graceful Shutdown"},{"slug":"LLM Integration","title":"LLM Integration"},{"slug":"Memory Systems","title":"Memory Systems"},{"slug":"Multi-Modal Memory","title":"Multi-Modal Memory"},{"slug":"Project Overview","title":"Project Overview"},{"slug":"Self-Improvement","title":"Self-Improvement"},{"slug":"Services","title":"Services"},{"slug":"Snake Agent Configuration","title":"Snake Agent Configuration"},{"slug":"Specialized Modules-57f9b30b-b165-48d3-8e89-196940d26190","title":"Specialized Modules"},{"slug":"Specialized Modules","title":"Specialized Modules"}]},"__N_SSG":true}